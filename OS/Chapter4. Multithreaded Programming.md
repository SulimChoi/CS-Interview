# :bookmark_tabs: Operating System Concepts 9th edition      
## 4장 Multithreaded Programming   
__중요하다고 생각되는 목차에는 :star: 표시해놓았습니다.__   
__:star:되어 있는 목차를 클릭하시면 클릭하신 목차의 내용이 있는 페이지로 넘어가며__   
__해당 페이지 내에 있는 중요 개념 옆에 :star: 표시해놓았습니다.__   

__혹시 잘못된 내용이 있거나 보완해야할 점이 있으면 `issue` 해주시거나 알려주시면 감사하겠습니다.:bow:__   

* [4.Multithreaded Programming](#4multithreaded-programming)   
  - [4.1 Overview](#41-overview) :star:  
    - [4.1.1 Motivation(동기)](#411-motivation동기) :star:   
    - [4.1.2 Benefit(이득)](#412-benefit이득) :star:   
  - [4.2 Multicore Programming](#42-multicore-programming) :star:   
    - [4.2.1 Programming Challenges(프로그래밍 과제)](#421-programming-challenges프로그래밍-과제)   
  - [4.3 Multithreading Models](#43-multithreading-models)   
  - [](#)   
  - [](#)   
  - [](#)   
  - [](#)   
  - [](#)   
  

## 4.Multithreaded Programming   
### 4.1 Overview   
  
  - __Thread__ :star:      
    - CPU 사용의 기본 단위   
    - 스레드 id, 프로그램 카운터, 레지스터 집합, 스택으로 구성   
    - 동일 프로세스에 속한 다른 스레드와 코드, 데이터 영역, OS 자원(열린 파일, 신호)를 공유한다.   
    #### 4.1 멀티 스레드 이미지    
    
#### 4.1.1 Motivation(동기)   

  - __Web Server가 단일 스레드 프로세스로 동작할 경우__   
    - 한번에 한 명의 Client에게만 서비스 제공하여 다른 Client는 오랜 시간을 기다려야 할 수도 있다.   
    
    - __해결 방법__ :star:   
      - __1. 프로세스 생성__   
        - __서버를 요청만 받는 단일 프로세스로 실행하게 하고 서비스를 제공할 별도의 프로세스를 생성한다.__  
        - 스레드가 유명해지기 전에 많이 사용되던 일반적인 방법   
        - __프로세스 생성은 시간 소모가 크고 자원을 많이 사용한다.__   
          - 새로운 프로세스가 존재하는 프로세스와 같은 작업을 할 경우 오버헤드를 초래할 수 있다.   
          - 그러므로 여러 스레드를 포함하는 하나의 프로세스를 사용하는 것이 훨씬 효율적이다.   
          
      - __2. 스레드 생성__   
        - __서버는 클라이언트 요청을 듣는 별도의 스레드를 생성하고, 요청을 받을 시 서비스를 제공할 스레드를 생성한다.__   
        #### 4.2 멀티 스레드 서버    
        
    - __스레드는 RPC에서 중요한 역할을 한다__   
      - 일반적으로 RPC 서버는 멀티스레드이다.   
      - 서버가 메세지를 받을 때, 별도의 스레드를 사용하여 해당 메세지를 서비스한다.   
      - 서버가 다수의 병행 요청에 대한 서비스를 할 수 있게 한다.   
      
    - __OS 커널도 멀티스레드이다.__   
      - 메모리 관리, 인터럽트 처리, 장치 관리 등 각 스레드가 수행한다.   
      
#### 4.1.2 Benefit(이득)    
  
  - __멀티스레드 프로그래밍 장점__ :star:      
    - __응답성(Responsivness)__   
      - 대화식 프로그램의 일부분이 block되거나 긴 작업을 수행하는 경우에도 프로그램 수행을 계속하게 함으로써 사용자에 대한 응답성을 증가시킨다.   
    - __자원 공유(Resource Sharing)__   
      - 프로세스는 오직 공유 메모리와 메세지 전달과 같은 기술을 통해 자원을 공유하며 이러한 기술은 프로그래머에 의해 명백하게 처리되어야 한다.   
      - 하지만, 스레드는 자동적으로 그들이 속한 프로세스의 자원들과 메모리를 공유한다.   
        - 코드와 자료 공유의 이점은 한 응용 프로그램이 같은 주소 공간 내에 여러 개의 다른 작업을 하는 스레드를 가질 수 있게 한다.   
        
    - __경제성(Economy)__   
      - 프로세스 생성을 위해 메모리와 자원을 할당하는 것은 비용이 많이 든다.   
      - 스레드는 자신이 속한 프로세스의 자원들을 공유하기 때문에 스레드를 생성하고 스레드간 문맥 교환하는 것이 훨씬 더 경제적이다.   
      - 오버헤드의 차이를 측정하는 것은 힘들 수 있으나 일반적으로 프로세스를 생성하고 관리하는데 더 많은 시간이 소요된다.   
        - ex) Solaris에서 프로세스 생성은 스레드 생성보다 3배 느리고, 문맥 교환은 5배 느리다.   
      
    - __확장성(Scalability)__   
      - 다중 스레드의 이점은 다중 처리기 구조에서 더욱 증가 된다.   
      - 각각의 스레드가 다른 처리기(프로세싱 코어)에서 병렬로 수행 될 수 있기 때문이다.   
      - 단일 스레드는 CPU가 많다고 하더라도 단지 한 CPU에서만 실행된다.   
        - 다중 CPU에서 다중 쓰레딩을 하면 병렬성이 증가 된다.   
        
        #### 4.3, 4.4 단일 코어, 멀티 코어 이미지   
        
  - __스레드를 위한 지원은 사용자 스레드(user thread)와 커널 스레드(kernel thread)가 있다.__ :star:   
    - __사용자 스레드__   
      - 커널 위에서 지원되며 커널의 지원없이 관리된다.   
    - __커널 스레드__   
      - OS에 의해 직접 지원되고 관리되며 대부분 OS가 커널 스레드를 지원한다.   
        
### 4.2 Multicore Programming    
  
  - __하나의 칩에 다수의 연산 코어가 들어간다.__   
    - 각 코어는 OS에서 별도의 프로세서로 표현된다.   
    
  - __멀티스레드 프로그래밍은 멀티 코어의 더 효율적인 사용과 더 향상된 병행성을 위한 메카니즘을 제공한다.__   
    - 하나의 프로세싱 코어는 한 번에 하나의 스레드만 실행시킬 수 있다.   
  
  - __단일 코어에서 병행성은 단지 스레드의 실행이 시간이 흐르면서 교차 배치되는 것을 의미한다.__   
  
  - __멀티 코어에서 병행성은 스레드를 병렬로 실행시킬 수 있는 것을 의미한다.__   
  
  - __병렬성과 병행성의 차이__ :star:      
    - __병렬성(Parallelism)__   
      - 물리적(기계) 성질   
      - 실제로 동시에 하나 이상의 작업이 수행된다.   
      - 오직 멀티 코어에서만 가능하다.   
      - ex) OpenMP, MPI, CUDA   
      
    - __병행성(Concurrency)__   
      - 논리적(프로그램) 성질    
      - 단일 코어에서는 물리적으로 병렬이 아닌 순차적으로 동작한다.   
        - ex) 멀티스레드 프로그램이 시분할 시스템처럼 CPU를 나눠 사용함으로써 사용자가 병행성을 느낄 수 있도록 해준다.   
        - 멀티스레드로 작성된 프로그램이라 하더라도 멀티코어가 아니면 병렬로 작동하지 못한다.   
      - ex) Mutex, Deadlock   
      
    - __멀티스레드 프로그램에서 벌어지는 버그를 concurrency bug라고 부르는데, 하드웨어가 반드시 병렬성을 지원하지 않더라도 논리적으로 발생하기 때문에 concurrency라고 한다.__   
    
#### 4.2.1 Programming Challenges(프로그래밍 과제)   

  - __멀티 코어 시스템을 위한 프로그래밍 과제 5가지__   
    - __작업 확인(Identifying tasks)__   
      - 분리되고 병행 작업으로 나뉠 수 있는 영역을 찾기 위해 app을 검사하는 것과 관련있다.   
      - 작업들은 각각 독립적이고 각 코어에서 병렬 수행 될 수 있다.   
    - __균형(Balance)__   
      - 병렬로 실행할 수 있는 작업들을 확인하는 동안, 프로그래머는 반드시 작업들이 동등하게 수행되는 것을 보장해야 한다.   
      - 일부 상황에서, 특정 작업이 다른 작업들보다 더 가치있게 고려될 수도 있다.   
        - 이러한 작업을 위해서 별도의 실행 코어를 사용하는 것은 비용적인 면에서 가치있지 않다.   
    - __데이터 분리(Data splitting)__   
      - app이 여러 작업들로 나뉘는 것처럼, 작업들에 의해 조작되고 접근되는 데이터는 별도의 코어에서 실행되기 위해 반드시 나뉘어져야 한다.   
    - __데이터 의존성(Data dependancy)__
      - 작업들에 의해 접근되는 데이터는 반드시 두 개 이상의 작업 사이에 의존성을 위해서 검사되어야 한다.   
      - 하나의 작업이 다른 작업의 데이터에 의존할 때, 프로그래머는 반드시 작업의 실행이 데이터 의존성을 이루기 위해서 동기화되게 보장해야 한다.   
    - __테스트, 디버그(Testing and debugging)__   
      - 프로그램이 다수 코어에서 병렬 수행될 때, 많은 다른 실행 경로가 존재한다.   
      - 병행 프로그램과 같은 디버그와 테스트는 단일 스레드 app을 테스트, 디버그하는 것 보다 훨씬 어렵다.   
     
### 4.3 Multithreading Models   
